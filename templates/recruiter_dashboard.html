{% extends "base.html" %}
{% block content %}

<!-- Header -->
<div class="flex justify-between items-center mb-8">
    <div>
        <h2 class="text-3xl font-bold text-white">Recruiter Dashboard</h2>
        <p class="text-gray-400">Manage your jobs & applications</p>
    </div>

    <a href="{{ url_for('post_job') }}"
       class="bg-emerald-600 hover:bg-emerald-500
              px-5 py-3 rounded-lg text-white font-semibold transition">
        ➕ Post New Job
    </a>
</div>

<!-- Jobs Section -->
{% if jobs %}
<div class="grid md:grid-cols-2 gap-6">

{% for job in jobs %}
<div class="bg-white/5 border border-white/10 rounded-2xl p-6">

    <h3 class="text-xl font-semibold text-indigo-400">
        {{ job.title }}
    </h3>
    <p class="text-gray-300 mt-2">
        {{ job.description }}
    </p>

    <!-- Applications -->
    <div class="mt-5">
        {% if job.applications %}
        <p class="text-sm text-gray-400 mb-3">
            Applications ({{ job.applications|length }})
        </p>

        <div class="space-y-3">
            {% for app in job.applications %}
            <div class="bg-white/10 p-4 rounded-lg border border-white/10">

                <!-- Applicant Info -->
                <p class="text-white font-semibold">
                    {{ app.user.username }}
                </p>
                <p class="text-sm text-gray-400">
                    {{ app.user.email }}
                </p>

                <p class="text-sm text-gray-300 mt-2">
                    {{ app.cover_letter or "No cover letter provided." }}
                </p>

                <!-- STATUS -->
                <p class="mt-2 font-semibold">
                    Status:
                    {% if app.status == "accepted" %}
                        <span class="text-green-400">Accepted ✅</span>
                    {% elif app.status == "rejected" %}
                        <span class="text-red-400">Rejected ❌</span>
                    {% else %}
                        <span class="text-yellow-400">Pending ⏳</span>
                    {% endif %}
                </p>

                <!-- ACTION BUTTONS -->
                {% if app.status == "pending" %}
                <div class="flex gap-3 mt-3">

                    <form method="POST"
                          action="{{ url_for('accept_applicant', app_id=app.id) }}">
                        <button class="bg-green-600 hover:bg-green-500
                                       px-4 py-1 rounded text-white font-semibold">
                            Accept
                        </button>
                    </form>

                    <form method="POST"
                          action="{{ url_for('reject_applicant', app_id=app.id) }}">
                        <button class="bg-red-600 hover:bg-red-500
                                       px-4 py-1 rounded text-white font-semibold">
                            Reject
                        </button>
                    </form>

                </div>
                {% endif %}

            </div>
            {% endfor %}
        </div>

        {% else %}
        <p class="text-sm text-gray-500 mt-4">
            No applications yet.
        </p>
        {% endif %}
    </div>

</div>
{% endfor %}

</div>

{% else %}
<p class="text-gray-400">
    You haven't posted any jobs yet.
</p>
{% endif %}

{% endblock %}
